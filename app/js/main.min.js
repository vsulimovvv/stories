console.clear();class Stories{el={};autoDelay=5e3;timer=null;isPause=!1;constructor(){if(this.el.demo=document.querySelector(".demo-stories"),this.el.stories=document.querySelector(".stories-slider"),!this.el.demo&&!this.el.stories)return!1;this.initDemo(),this.initStories()}initDemo(){const t=this;t.el.demo.addEventListener("click",s=>{var e=s.target.closest("a");if(e){s.preventDefault();s=e.dataset.storiesIndex;if(!(s&&0<=+s))return!1;t.storiesOpenUser(+s)}})}initStories(){const t=this;t.el.stories.addEventListener("click",s=>{s.target.closest("button.stories-slider-close-button")&&t.storiesModalClose();var e=s.target.closest(".stories-slider-button.stories-slider-button-prev"),e=(e&&t.buttonPrev(),s.target.closest(".stories-slider-button.stories-slider-button-next"));e&&t.buttonNext()}),t.el.stories.addEventListener("animationend",s=>{t.el.stories.classList.contains("stories-slider-out")&&t.el.stories.classList.remove("stories-slider-out"),t.el.stories.classList.contains("stories-slider-in")&&t.swiperStories&&(t.checkContent(),t.startProgress())}),t.swiperUsers=new Swiper(t.el.stories.querySelector(".js-swiper-pagination-progress-with-thumbs-main-2"),{effect:"cube",cubeEffect:{shadow:!1,slideShadows:!0},on:{transitionEnd:s=>{t.changeSlide(s),t.checkContent()},touchStart:()=>{t.isPause=!0,t.video&&t.video.pause(),t.timerTouch&&clearTimeout(t.timerTouch),t.timerTouch=setTimeout(()=>{t.isTouch=!0},250)},touchEnd:()=>{t.isPause=!1,t.video&&t.video.play(),t.timerTouch&&clearTimeout(t.timerTouch),t.timerTouch=setTimeout(()=>{t.isTouch=!1},100)}}}),t.el.stories.querySelectorAll(".js-swiper-pagination-progress-with-thumbs-main-2 .swiper").forEach(s=>{new Swiper(s,{slidesPerView:1,effect:"fade",speed:1,pagination:{type:"custom",el:s.querySelector(".stories-slider-pagination"),bulletClass:"stories-slider-pagination-bullet",bulletActiveClass:"stories-slider-pagination-bullet-active",renderCustom:(s,i,e)=>{i--;const r=s.originalParams.pagination;return Array(e).fill("").map((s,e)=>{var t=[r.bulletClass];return e===i&&t.push(r.bulletActiveClass),e<i&&t.push(r.bulletClass+"-viewed"),`<div class="${t.join(" ")}"></div>`}).join("")}},on:{slideChange:s=>{t.changeSlide(s),t.checkContent()}}})})}buttonPrev(){if(this.isTouch)return!1;(this.swiperStories.isBeginning?this.swiperUsers:this.swiperStories).slidePrev()}buttonNext(){if(this.isTouch)return!1;(this.swiperStories.isEnd?this.swiperUsers:this.swiperStories).slideNext()}startProgress(){const s=this;var e;s.swiperStories&&(s.stopProgress(),e=s.autoDelay/100,s.progress=0,s.swiperStories?.el.style.setProperty("--progress",s.progress),s.timer=setInterval(()=>{if(s.video)return s.stopProgress(),!1;s.progress<=100&&!s.isPause&&(s.progress+=1),s.swiperStories?.el.style.setProperty("--progress",s.progress),s.swiperStories?.isEnd&&100===s.progress?(s.stopProgress(),s.swiperUsers.isEnd&&s.storiesModalClose(),s.swiperUsers.slideNext()):100===s.progress&&s.swiperStories?.slideNext()},e))}changeSlide(s){this.stopProgress(),this.startProgress(),this.getActiveSwiperStoriesInSwiperUsers()}stopProgress(){clearInterval(this.timer),this.progress=0,this.swiperStories?.el.style.setProperty("--progress",this.progress)}checkContent(){var s=this,e=s.swiperStories.slides[s.swiperStories.activeIndex].querySelector(".stories-slider-content video");s.stopVideo(),e?(s.stopProgress(),s.video=e,s.video.addEventListener("timeupdate",s.videoProgress.bind(s)),e.play()):s.video=null}videoProgress(s){this.progress=s.target.currentTime/(s.target.duration%60)*100,this.swiperStories?.el.style.setProperty("--progress",this.progress),this.swiperStories?.isEnd&&100<=this.progress?(this.stopProgress(),this.swiperUsers.isEnd&&this.storiesModalClose(),this.swiperUsers.slideNext()):100<=this.progress&&this.swiperStories?.slideNext()}stopVideo(){if(!this.video)return!1;this.video.pause(),this.video.currentTime=0,this.video.removeEventListener("timeupdate",this.videoProgress)}storiesOpenUser(s){this.swiperUsers.slideTo(s,0,!0),this.getActiveSwiperStoriesInSwiperUsers(),this.swiperStories.slideTo(0,0,!0),this.storiesModalOpen()}getActiveSwiperStoriesInSwiperUsers(){var s=this.swiperUsers.slides[this.swiperUsers.activeIndex].querySelector(".swiper");s?this.swiperStories=s.swiper:this.storiesModalClose()}storiesModalOpen(){if(this.el.stories.classList.contains("stories-slider-in"))return!1;document.body.style.overflow="hidden",this.el.stories.classList.add("stories-slider-in")}storiesModalClose(){if(!this.el.stories.classList.contains("stories-slider-in"))return!1;this.stopProgress(),this.stopVideo(),document.body.style.overflow="",this.el.stories.classList.remove("stories-slider-in"),this.el.stories.classList.add("stories-slider-out"),this.swiperStories=null}}new Stories;